plugins {
    id "com.android.library"
    id "kotlin-android"
    id "kotlin-kapt"
}

android {
    buildTypes {
        release {
            buildConfigField "boolean", "SEND_EVENTS", "true"
        }
        debug {
            buildConfigField "boolean", "SEND_EVENTS", getProperty('config.enableAnalyticsForDebugBuilds')
        }
    }
}

dependencies {
    def app = rootProject.ext.mainApplication
    def analytics = rootProject.ext.analytics
    implementation app.kotlin
    implementation app.coroutinesAndroid
    implementation app.timber
    implementation analytics.amplitude
}

tasks.register("enableAnalyticsForDebugBuilds") {
    doLast {
        enableAnalyticsForDebugBuilds()
    }
}

def enableAnalyticsForDebugBuilds() {
    def file = file('gradle.properties')
    def content = "config.enableAnalyticsForDebugBuilds=true"
    file.text = content.toString()
}