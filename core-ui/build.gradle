apply plugin: 'com.android.library'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-android-extensions'

android {
    def config = rootProject.extensions.getByName("ext")

    compileSdkVersion config["compile_sdk"]

    defaultConfig {
        minSdkVersion config["min_sdk"]
        targetSdkVersion config["target_sdk"]

        testInstrumentationRunner config["test_runner"]
    }


    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }

    flavorDimensions 'default'
    productFlavors {
        stable {
            dimension 'default'
        }
        experimental{
            dimension 'default'
        }
    }

    sourceSets {
        stable {
            java {
                srcDirs 'src/stable/java'
            }
            res {
                srcDirs 'src/stable/res'
            }
        }
        experimental {
            java {
                srcDirs 'src/experimental/java'
            }
            res {
                srcDirs 'src/experimental/res'
            }
        }
    }

    testOptions {
        unitTests {
            includeAndroidResources = true
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_11
        targetCompatibility JavaVersion.VERSION_11
    }

    kotlinOptions {
        jvmTarget = JavaVersion.VERSION_11
    }
    lint {
        abortOnError false
    }
}

dependencies {
    def applicationDependencies = rootProject.ext.mainApplication
    def unitTestDependencies = rootProject.ext.unitTesting

    implementation project(':core-utils')
    implementation project(':core-models')
    implementation project(':presentation')
    implementation project(':library-emojifier')
    implementation project(':library-syntax-highlighter')

    implementation applicationDependencies.appcompat
    implementation applicationDependencies.kotlin
    implementation applicationDependencies.coroutinesAndroid
    implementation applicationDependencies.androidxCore

    implementation applicationDependencies.design
    implementation applicationDependencies.recyclerView
    implementation applicationDependencies.constraintLayout
    implementation applicationDependencies.glide
    implementation applicationDependencies.shimmerLayout
    implementation applicationDependencies.timber
    implementation applicationDependencies.betterLinkMovement
    implementation applicationDependencies.exoPlayer
    implementation applicationDependencies.urlcleaner
    implementation applicationDependencies.katex

    testImplementation unitTestDependencies.junit
    testImplementation unitTestDependencies.kotlinTest
    testImplementation unitTestDependencies.robolectricLatest
    testImplementation unitTestDependencies.androidXTestCore
    testImplementation unitTestDependencies.mockitoKotlin
}